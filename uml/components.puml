@startuml components
title labelle-tasks Components

package "Core Types" {
  enum Priority {
    Low
    Normal
    High
    Critical
  }

  enum StepType {
    Pickup
    Cook
    Store
    Craft
  }

  class StepDef <<struct>> {
    type: StepType
  }
}

package "Engine" {
  enum WorkerState {
    Idle
    Working
    Blocked
  }

  enum WorkstationStatus {
    Blocked
    Queued
    Active
  }

  class Worker <<internal>> {
    game_id: GameId
    state: WorkerState
    assigned_to: ?WorkstationId
    skills: ?SkillSet
  }

  class Workstation <<internal>> {
    game_id: GameId
    status: WorkstationStatus
    priority: Priority
    steps: []const StepDef
    current_step: u8
    assigned_worker: ?WorkerId
    room: ?[]const u8
  }

  class SkillSet <<struct>> {
    bits: u32
    --
    has(skill): bool
    add(skill): void
  }

  note bottom of Worker
    Registered via addWorker()
    with game entity ID
  end note

  note bottom of Workstation
    Registered via addWorkstation()
    with steps and priority
  end note

  Workstation --> StepDef : contains
  Worker --> SkillSet : optional
}

@enduml

@startuml kitchen_structure
title Kitchen Structure - Full Storage Flow

package "Game World (External Inputs)" {
  storage "Meat Storage A" as meat_a
  storage "Meat Storage B" as meat_b
  storage "Vegetable Storage" as veg_ext
}

package "Kitchen (Task Group)" {
  package "Internal Input Storages" {
    storage "Internal Meat Slot" as meat_internal
    storage "Internal Vegetable Slot" as veg_internal
  }

  node "Cooking Station\n(Workstation)" as cooking

  package "Internal Output Storage" {
    storage "Cooked Food Slot" as food_internal
  }
}

package "Game World (External Outputs)" {
  storage "Food Storage A" as food_a
  storage "Tavern Storage" as tavern
}

meat_a ..> meat_internal : <color:gray>Fill (if available)</color>
meat_b ..> meat_internal : <color:green>Fill</color>
veg_ext ..> veg_internal : Fill

meat_internal --> cooking : ingredients
veg_internal --> cooking : ingredients
cooking --> food_internal : produces

food_internal ..> food_a : <color:green>Store</color>
food_internal ..> tavern : <color:gray>Store (alternative)</color>

note bottom of meat_a
  Source resolved dynamically
  via findSource callback
end note

note bottom of food_a
  Destination resolved dynamically
  via findDestination callback
end note

@enduml

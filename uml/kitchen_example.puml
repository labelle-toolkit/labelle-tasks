@startuml kitchen_example
title Kitchen Workstation - Example Flow

participant "Game Loop" as game
participant "Engine" as engine
participant "Kitchen" as kitchen
participant "Chef" as chef

== Initialization ==
game -> engine : init(allocator)
game -> engine : addWorker(chef_id, {})
game -> engine : addWorkstation(kitchen_id,\n{steps: [Pickup, Cook, Store], priority: .High})
game -> engine : setFindBestWorker(findBestWorker)
game -> engine : setOnStepStarted(onStepStarted)
game -> engine : setShouldContinue(shouldContinue)

== Resources Available ==
game -> engine : notifyResourcesAvailable(kitchen_id)
engine -> engine : findBestWorker(kitchen_id, .Pickup, [chef_id])
engine --> game : chef_id selected
engine -> kitchen : status = Active
engine -> chef : state = Working

== Step Execution ==
engine -> game : onStepStarted(chef_id, kitchen_id, {.Pickup})
note right: Game starts chef movement\nand pickup animation

game -> engine : notifyStepComplete(chef_id)
engine -> game : onStepStarted(chef_id, kitchen_id, {.Cook})
note right: Game starts cooking animation

game -> engine : notifyStepComplete(chef_id)
engine -> game : onStepStarted(chef_id, kitchen_id, {.Store})
note right: Game starts storage animation

game -> engine : notifyStepComplete(chef_id)

== Cycle Complete ==
engine -> game : shouldContinue(kitchen_id, chef_id, 1)
alt shouldContinue returns true
  engine -> kitchen : status = Blocked\n(waiting for resources)
  note right: Chef stays assigned\nwaiting for next cycle
else shouldContinue returns false
  engine -> game : onWorkerReleased(chef_id, kitchen_id)
  engine -> chef : state = Idle
  engine -> kitchen : status = Blocked
end

@enduml
